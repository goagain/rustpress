package rustpress:system;

interface hooks {
    record post-data {
        id: s64,
        title: string,
        content: string,
        category: option<string>,
        author-id: s64,
        created-at: string,
        updated-at: string,
    }

    record category-info {
        name: string,
        count: s64,
    }

    on-post-published: func(post: post-data) -> result<post-data, string>;
    list-categories: func() -> list<category-info>;
}

interface logging {
    log-info: func(message: string);
    log-warn: func(message: string);
    log-error: func(message: string);
    log-debug: func(message: string);
}

interface ai {
    record chat-message {
        role: string,
        content: string,
    }

    record chat-completion-request {
        model: option<string>,
        messages: list<chat-message>,
        max-tokens: option<s64>,
    }

    record chat-completion-choice {
        message: chat-message,
        finish-reason: string,
    }

    record chat-completion-usage {
        prompt-tokens: s64,
        completion-tokens: s64,
        total-tokens: s64,
    }

    record chat-completion-response {
        id: string,
        object: string,
        created: s64,
        model: string,
        choices: list<chat-completion-choice>,
        usage: chat-completion-usage,
    }

    chat-completion: func(request: chat-completion-request) -> result<chat-completion-response, string>;
    list-models: func() -> list<string>;
}

world plugin-world {
    import logging;
    export hooks;
}
